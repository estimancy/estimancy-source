<style>
  select, input{
    width: 100px;
  }
</style>

<div class="tabs">
  <ul>
    <li>
      <a href="#tabs-1">UOs Modules</a>
    </li>
  </ul>

  <%= form_tag "/save_uos" do %>

    <%= hidden_field_tag "module_project_id", @module_project.id %>
    <div id="tabs-1" style="overflow-x: auto;">
      <table id="myTable" class="table table-striped table-bordered table-condensed ">
        <tr>
          <th colspan="6"></th>
          <th colspan="3">Size</th>
          <th></th>
          <th colspan="3"> Gross Value </th>
        </tr>
        <tr>
          <th>Actions</th>
          <th>Flag</th>
          <th>Items</th>
          <th>ItemsTechnology</th>
          <th>Uos</th>
          <th>Complexity</th>
          <th>Low</th>
          <th>Most Likely</th>
          <th>High</th>
          <th>Weight</th>
          <th>Low</th>
          <th>Most Likely</th>
          <th>High</th>
        </tr>

        <tr>
          <th colspan="6">Overall</th>
          <td class="span1">
            <%= text_field_tag "size_low", @size.nil? ? '' : @size.string_data_low[current_component.id] %>
          </td>
          <td class="span1">
            <%= text_field_tag "size_most_likely", @size.nil? ? '' : @size.string_data_most_likely[current_component.id] %>
          </td>
          <td class="span1">
            <%= text_field_tag "size_high", @size.nil? ? '' : @size.string_data_high[current_component.id] %>
          </td>
          <td> - </td>
          <td class="span1">
            <%= text_field_tag "gross_low", @gross_size.nil? ? '' : @gross_size.string_data_low[current_component.id] %>
          </td>
          <td class="span1">
            <%= text_field_tag "gross_most_likely", @gross_size.nil? ? '' : @gross_size.string_data_low[current_component.id] %>
          </td>
          <td class="span1">
            <%= text_field_tag "gross_high", @gross_size.nil? ? '' : @gross_size.string_data_low[current_component.id] %>
          </td>
        </tr>

        <%= render :partial => 'row' %>
      </table>

      <%= submit_tag I18n.t(:save), :class => "btn" %>
      <%= submit_tag I18n.t(:apply), :class => "btn" %>

    </div>

  <% end %>

</div>

<script>
  $(document).ready(function(){
    $(".size, .weight, #technology_1, #uow_1, #complexity_1").on("blur change", function(){
      $.ajax({ url:'/load_gross',
        data:'size=' + this.value + '&weight=' + $('#weight_1').val()
                + '&technology=' + $('#technology_1').val()
                + '&uow=' + $('#uow_1').val()
                + '&complexity=' + $('#complexity_1').val()
                + '&level=' + $(this).attr("data-level")
      });
    });

    var i = 0;
    $(".icon").on("click",  function( event ){
//      var i = $(event.target).closest("tr").index(event.target)
      $(event.target).closest("table").last().append("<%=raw j(render :partial => 'row') %>")
    });
    i++;
  });

</script>