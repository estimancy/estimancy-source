<%= form_tag guw.guw_unit_of_work_save_coefficient_comments_path(guw_unit_of_work), method: "post" do %>

  <%= hidden_field_tag "guw_coefficient_element_id", guw_coefficient_element.nil? ? nil : guw_coefficient_element.id %>
  <%= hidden_field_tag "guw_coefficient_id", guw_coefficient.nil? ? nil : guw_coefficient.id %>
  <%= hidden_field_tag "guw_unit_of_work_id", guw_unit_of_work.nil? ? nil : guw_unit_of_work.id %>
  <%= hidden_field_tag "value", @value %>
  <%= hidden_field_tag "previousValue", @previousValue %>

  <% ceuw = Guw::GuwCoefficientElementUnitOfWork.where(guw_coefficient_element_id: guw_coefficient_element.id,
                                                       guw_coefficient_id: guw_coefficient.id,
                                                       guw_unit_of_work_id: guw_unit_of_work.id).first %>

  <div class="modal-header modal-drag">
    <h4 class="modal-title">
      Commentaire du coefficient <%= guw_coefficient.name %> obligatoire
    </h4>
  </div>
  <div class="modal-body">

    <p>
      <%= guw_unit_of_work.name %>
    </p>

    <label>
      <b>
        <%= I18n.t(:comments) %>
      </b>
    </label>

    <%= text_area_tag "comments", ceuw.nil? ? "" : ceuw.comments, class: "attribute_note_area", rows: 4  %>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal"><%= I18n.t(:close) %></button>
    <button type="submit" class="btn btn-default submit_comments" <%= ceuw.comments.nil? ? 'disabled' : '' %>">
      <%= I18n.t(:save) %>
    </button>
  </div>
<% end %>

<script>
  $(".attribute_note_area").keyup(function(e) {
    console.log('okk');
    var empty = false;
    $(".attribute_note_area").each(function() {
      if ($(this).val().length == 0) {
        empty = true;
      }
    });
    if (empty) {
      $(".submit_comments").attr('disabled', 'disabled');
    } else {
      $(".submit_comments").removeAttr('disabled');
    }
  });
</script>
