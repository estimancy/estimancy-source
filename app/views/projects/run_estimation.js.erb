//Get the current_component first
<% @current_component = current_component %>

$('#notifications').html("<%=raw j "<div class='alert alert-success pull-left'>
                                        <button type='button' class='close' data-dismiss='alert'>x</button>
                                        #{I18n.t(:notice_end_of_estimation_execution)}
                                    </div>" %>");

$("#project_wbs_product_section .tab-pane.active").html("<%=raw j generate_wbs_product(@project.root_component, @project, '', 5) %>");

$(".input_data").html("<%=raw j(display_input) %>");

$(".output_data").html("<%=raw j(sanitize(display_results, :tags => %w(table tr th td span title h4 strong), :attributes => %w(id class style title colspan rowspan))) %>");

$(".component_name").html("<%=raw @current_component %>");

$('.component_tree ul li, .widget-content ul li').hover(
        function () {
          $(this.children).css('display', 'block');
        },
        function () {
          $('.block_link').hide();

        }
);

$('.spiner').hide();

$("#pbs_list").val(<%= @current_component.nil? ? '' : @current_component.id %>);

$(".header_data").html("<h5><%= @current_component %> - <%= current_module_project %></h5>");

//Allow to copy value from one field to another
$('.copyLib').css( 'cursor', 'pointer' );
$(".copyLib").click(function(){
    var effort_input_id = "_low"+$(this).data("effort_input_id");
    var first_value = $("#"+effort_input_id).val();

    var low_level =         "_low"+$(this).data("effort_input_id");
    var most_likely_level = "_most_likely"+$(this).data("effort_input_id");
    var high_level =        "_high"+$(this).data("effort_input_id");

    document.getElementById(low_level).value = first_value;
    document.getElementById(most_likely_level).value = first_value;
    document.getElementById(high_level).value = first_value;
    return false;
});

$('.input-small').bind("blur",(
        function(){
            $.ajax({
                url:"check_attribute",
                type: 'POST',
                data: "value=" + this.value + "&level=" + this.className.split(/\s/)[1] + "&est_val_id=" + $(this).data("est_val_id") + "&wbs_project_elt_id=" + $(this).data("wbs_project_elt_id")
            })
        }
        ));

$(".date-picker").datepicker({
    language: '<%= set_user_language %>',
    autoclose: true,
    todayHighlight: true,
    todayBtn: true
}).on("hide", function(e){
            $.ajax({
                url:"check_attribute",
                type: 'POST',
                data: "value=" + this.value + "&level=" + this.className.split(/\s/)[1] + "&est_val_id=" + $(this).data("est_val_id") + "&wbs_project_elt_id=" + $(this).data("wbs_project_elt_id")
            })
        });

$('.attribute_tooltip').tooltip({'html' : true });

// If single_attribute_value, data if low = most_likely=high
$(".single_entry_attribute").change(function(){
    var effort_input_id = $(this).attr('id');
    var first_value = $("#"+effort_input_id).val();

    var common_on_id = effort_input_id.split("_low")[1];
    var low_level =         "_low"+common_on_id;
    var most_likely_level = "_most_likely"+common_on_id;
    var high_level =        "_high"+common_on_id;

    document.getElementById(low_level).value = first_value;
    document.getElementById(most_likely_level).value = first_value;
    document.getElementById(high_level).value = first_value;
    return false;
});