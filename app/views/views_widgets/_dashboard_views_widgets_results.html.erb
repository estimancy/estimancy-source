<% @module_positions.times do |j| %>    <!-- @module_positions is the Max Y position of last module -->
    <% position_y = j+1 %>

    <div class="row-fluid"> <!-- div for Y position -->
      <!-- Iteration for each module in position_y -->
      <% @module_positions_x.times do |i| %>
          <% position_x = i+1 %>
          <% span_size =  12/@module_positions_x %>

          <div class='<%= "span#{span_size}" %>'> <!-- div for X position -->
            <!-- Get the ModuleProject in position (position_x, position_y)  -->
            <% module_project = current_project.module_projects.find_by_position_x_and_position_y(position_x, position_y)  %>

            <% if module_project.nil? || !module_project.show_results_view %>
                <div class="widget-box collapsible none-module">  <!-- One widget-box when there is no module_project at that position -->
                </div>
            <% else %>
                <div class="widget-box collapsible">  <!-- One widget-box by module -->
                  <div class="widget-title" style="background-color: <%= module_project.color.nil? ? "lightgrey" : "##{module_project.color}" %>; border-bottom: 1px solid <%="##{module_project.color}"%>;">
                    <div class="view_header_data">
                      <h5 class="view_title"><%= "#{module_project}" %></h5>
                      <div class="pull-right">
                        <%= link_to "", new_views_widget_path(module_project_id: module_project.id, view_id: module_project.view_id), class: "icon icon-plus", title: I18n.t(:label_add_new_view_widget), remote: true %>
                        <%= link_to "", "#", id: "update_view_widgets_order", class: "icon icon-save", title: I18n.t(:label_update_view_widgets_order), remote: true %>
                      </div>
                    </div>
                  </div>
                  <div class="widget-content" class="<%= "module_project_widget_#{module_project.id}" %>">
                    <div id="<%="view_widgets_container_#{module_project.id}"%>" class="row-fluid">
                      <!-- Show all widgets on the current view -->
                      <% if module_project.view %>
                          <% module_project.view.views_widgets.order('position').each do |view_widget| %>
                            <% view_widget_data = get_view_widget_data(module_project.id, view_widget.id) %>
                            <% value_to_show = view_widget_data[:value_to_show] %>
                            <!--<div class="span3 text-center view_widget" data-view_widget_id="<%#= view_widget.id %>" style="<%#= add_top_and_left %>  margin-left: 0px; margin-right:5px;  background-color: <%#= view_widget.color %>; min-height: <%#= 3 * 50%>px; min-width: 120px; padding-top: <%#= 2 * 2%>em; margin-bottom: 10px;">-->
                            <div id="<%= "dashboard_widget_#{view_widget.id}" %>" class="span3 text-center view_widget" data-view_widget_id="<%= view_widget.id %>" data-container_id="<%="view_widgets_container_#{module_project.id}"%>" style="margin-left: 0px; margin-right:10px; margin-bottom: 10px;  background-color: <%= view_widget.color %>; min-height: 150px; min-width: 150px; height: <%=view_widget_data[:height]%>px; width: <%=view_widget_data[:width]%>px;">
                              <div id="show_view_widget_params_<%= view_widget.id %>" class="widget_icon_edit">
                                <%= link_to '', edit_views_widget_path(view_widget, module_project_id: module_project.id, view_id: module_project.view_id), class: 'icon-pencil', title: I18n.t(:edit_widget), remote: true %>
                                <%= link_to(' ', view_widget, confirm: I18n.t('are_you_sure'), method: :delete, :class => 'icon-trash', :title => I18n.t('delete')) %>
                              </div>

                              <div class="row-fluid" style="padding-top: 2em; ">
                                <% if view_widget.show_min_max %>
                                 <div class="row-fluid">
                                    <div class="span6">
                                        <div class="fa <%= view_widget.icon_class %> icon_size" title="<%= view_widget.name %>"></div>
                                        <div class="widget_text">
                                          <%= value_to_show %>
                                        </div>
                                    </div>
                                    <div class="span6 min_max">
                                        <p><%= view_widget_data[:max_value_text] %></p>
                                        <p><%= view_widget_data[:min_value_text] %></p>
                                    </div>
                                 </div>

                                <% else %>
                                    <span class="icon fa <%= view_widget.icon_class %> icon_size" title="<%= view_widget.name %>"></span>
                                    <div class="widget_text">
                                      <%= value_to_show %>
                                    </div>
                                <% end %>
                              </div>
                            </div>
                          <% end %>
                        <!--</ul>-->
                      <% end %>
                      <!--<div class="span9 text-center" style="height: <%#= 3 * 80%>px; " >-->
                        <!--<%#= timeline [["Washington", "1789-04-29", "1797-03-03"], ["Adams", "1797-03-03", "1801-03-03"], ["Jefferson", "1801-03-03", "1809-03-03"]] %>-->
                      <!--</div>-->
                    </div>
                  </div>  <!-- end widget content -->
                </div>  <!-- END widget-box by module -->
            <% end %>
          </div>   <!-- END div for each X position -->
      <% end %>    <!-- Iteration for X position -->
    </div>  <!-- END div for Y position -->
<% end %>   <!-- Iteration for Y position -->




