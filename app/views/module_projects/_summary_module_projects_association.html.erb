<%= form_tag url_for({:action=> 'associate_modules_projects', :controller=> 'module_projects', :project_id => @project.id}),{:method => 'POST', :class=>'simple_form'} do %>
  <h1>Associate modules</h1>
  <table class="table table-striped table-bordered table-condensed">
    <tr>
      <th>Module projects</th>
      <% @module_projects.each do |mp| %>
        <th>
          <%= mp.pemodule.title %>
        </th>
      <% end %>
    </tr>

    <% @module_projects.each_with_index do |i, l| %>
      <tr>
        <td>
          <strong><%= i.pemodule.title %> (<%= i.position_x %>;<%= i.position_y %>)</strong>
        </td>
        <% @module_projects.each_with_index do |j, k| %>
          <td>
            <% if  k<l && i.position_y!=j.position_y %>
              <%= check_box_tag("module_projects[#{i.id}][]", j.id, (i.associated_module_projects.map(&:id).include?(j.id)) )%>
            <% else %>
              -
            <% end %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </table>

  <%= submit_tag I18n.t('save'), :class => 'btn ' %>
  <%= submit_tag I18n.t('apply'), :class => 'btn' %>
<% end %>
